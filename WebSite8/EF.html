<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link href="B01/StyleSheet2.css" rel="stylesheet" />

    <style>
        #D001 {
            width: 100%;
        }

        hr {
            display: block;
            margin-top: 0.5em;
            margin-bottom: 0.5em;
            margin-left: auto;
            margin-right: auto;
            border-style: inset;
            border-width: 1px;
        }
    </style>
</head>

<body>
    <div class="jumbotron text-center">
        <h1 align="center">DevDiary</h1>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-sm-4 text-center">
                <h3></h3>
            </div>
            <div class="col-sm-4 text-center">
                <h3><a href="001.html">HOME</a></h3>
            </div>
            <div class="col-sm-4 text-center">
                <h3></h3>
            </div>
        </div>
    </div>

    <br>

    <div class="container">
        <div class="row">
            <div class="col-sm-2">
                <h3></h3>
            </div>
            <div class="col-sm-8">
                <hr>

                <!--<p><span style="color:#333333;"><strong>10/06/2021: Shakespeare and Company</strong></span><br /><span style="color:#333333;">On YT I recently discovered an</span> <a href="https://www.youtube.com/watch?v=R1Zbw39MCm4" target="_blank" rel="noopener">interview</a> <span style="color:#333333;">with Sylvia Beach in 1962. I had never seen a video of her talking and it was great because I could compare what I was watching to Hemingway&#8217;s description of her in &#8220;A Moveable Feast&#8221;. The stories she told about the occupation of Paris, how it affected her and the bookshop, the liberation of Paris and Hemingway, were wonderful.</span></p>
    <img id="img1" src="https://thebalancedwriter521.files.wordpress.com/2021/06/3424.jpg" />

    <br><br>
    <hr>

    <p><span style="color:#333333;"><strong>16/05/2021: Walter Mosley</strong></span><br /><span style="color:#333333;">On YT, a few months ago I discovered Walter Mosley. I love listening to his interviews on YT because he is my favourite kind of writer, he knows how to talk. He values poetry, storytelling and he has a rare balance between intellect and passion. I love this <a href="https://www.youtube.com/watch?v=1Og-zn9OBIY" target="_blank" rel="noopener">video</a>.  </span></p>
    <img id="img1" src="https://thebalancedwriter521.files.wordpress.com/2021/06/wm4424.png" />

    <br><br>-->

                <h1>Entity Framework Notes</h1><br>

                <p><span style="color:#333333;"><strong>NOTES : Intro 1</strong></span></p>
                <p><span style="color:#333333;">Entity Framework translates LINQ queries into the appropriate SQL statements, so that they can be executed against a database.</span></p>
                <p><span style="color:#333333;">Databases allow us to persist data across application starts and user sessions.</span></p>
                <p><span style="color:#333333;">Persisting data across application starts and user sessions allows users to create, update, or delete data on one day, and return on another day and still see the changes that they had previously made.</span></p>
                <p><span style="color:#333333;">Entity Framework is an open source &#8220;Object-Relational Mapper&#8221; or ORM framework.</span></p>
                <p><span style="color:#333333;">Using an ORM allows us to interact with our application&#8217;s data using C# code.</span></p>
                <p><span style="color:#333333;">Entities in Entity Framework are just plain old C# (or class) objects—or POCOs.</span></p>
                <p><span style="color:#333333;">POCO classes don&#8217;t inherit or depend on any framework-specific base class; they&#8217;re just regular classes.</span></p>
                <p><span style="color:#333333;">Databases that store data in tables are known as &#8220;Relational&#8221; databases.</span></p>
                <p><span style="color:#333333;">SQL Server is a relational database that is commonly used with EF.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES : Intro 2</strong></span></p>
                <p><span style="color:#333333;">The context class contains a collection of &#8220;DbSet&#8221; properties, one property for each entity that you need to write queries for.</span></p>
                <p><span style="color:#333333;">The Entity Framework DbContext class implements the &#8220;IDisposable&#8221; interface which provides a mechanism for releasing unmanaged resources, through its single method, Dispose.</span></p>
                <p><span style="color:#333333;">Describing the shape of your data by defining entities, properties on those entities, and the relationships between entities, is known as &#8220;Data Modelling&#8221;.</span></p>
                <p><span style="color:#333333;">Data modeling is often the first step in database design and object-oriented programming, though it&#8217;s almost always an activity that continues throughout the development process as your understanding of the requirements evolves.</span></p>
                <p><span style="color:#333333;">All communication from our application to the database flows through the &#8220;Context&#8221; class.</span></p>
                <p><span style="color:#333333;">The context can be used to retrieve entities from the database, persist new and changed entities to the database, and even to remove entities from the database.</span></p>
                <p><span style="color:#333333;">The context class is our gateway to the database—all communication from our application to the database flows through the context.</span></p>
                <p><span style="color:#333333;">When using the Code First workflow, your entity class names will by default become the database table names—either the singular or plural versions depending on how EF is configured.</span></p>
                <p><span style="color:#333333;">While this is the default convention, it can be overridden using data annotation attributes or the fluent API.</span></p>
                <p><span style="color:#333333;">Entity class &#8220;key&#8221; properties (properties that are mapped to primary key columns in the database) can be named using the following conventions: Id, ID, {ClassName}Id, {ClassName}ID.</span></p>
                <p><span style="color:#333333;">Which workflow would you use if you want to use the visual EF Designer to define your model and you don&#8217;t have an existing database? &#8220;Model First&#8221;.</span></p>
                <p><span style="color:#333333;">When you make changes to your model using the EF Designer, EF will drop and create the database.</span></p>
                <p><span style="color:#333333;">Which workflows can be used with an existing database? &#8220;Database First and Code First&#8221;.</span></p>
                <p><span style="color:#333333;">The Database First workflow was created to be used with existing databases and the Code First workflow provides an option to generate your entity and context classes from an existing database as a one-time operation.</span></p>
                <p><span style="color:#333333;">Which workflow allows you to define your model by writing code for your entity and context classes? &#8220;Code First&#8221;.</span></p>
                <p><span style="color:#333333;">Using the Code First workflow allows you to define and manipulate the data persistence for your applications in a very natural way—as you write the C# code for the app itself.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES: Entity Framework and Databases 1</strong></span></p>
                <p><span style="color:#333333;">The &#8220;ProjectsV13&#8221; LocalDB instance is created specifically for SQL Server Data Tools and shouldn&#8217;t be used for application development. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">The &#8220;MSSQLLocalDB&#8221; LocalDB instance should be used for application development.</span></p>
                <p><span style="color:#333333;">MSSQLLocalDB is the LocalDB default instance name used by SQL Server 2014 and 2016 (versions 12 and 13 respectively).</span></p>
                <p><span style="color:#333333;">Which of the following commands will list the available LocalDB instances? &#8220;sqllocaldb info&#8221;.</span></p>
                <p><span style="color:#333333;">Being able to list the available LocalDB instances is helpful when you need to debug Entity Framework database connection issues.</span></p>
                <p><span style="color:#333333;">Getting started with Entity Framework is expensive as you must purchase a commercial license for SQL Server. &#8220;False.</span></p>
                <p><span style="color:#333333;">Fortunately, we can target a free, developer-centric version of SQL Server named LocalDB, which is installed by default when you install Visual Studio Community.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES: Entity Framework and Databases 2</strong></span></p>
                <p><span style="color:#333333;">When using the Code First workflow, adding a database connection string—whose name matches the name of our context class—to our app&#8217;s configuration file allows us to customize the name of the generated database.</span></p>
                <p><span style="color:#333333;">Using this option makes it possible to change the location or name of the database without having to rewrite our code, which is especially helpful when deploying applications into other environments.</span></p>
                <p><span style="color:#333333;">During development, which of the following database initializer classes can be used to drop and create the database every time that a change to the model is made? &#8220;DropCreateDatabaseModelChanges&#8221;.</span></p>
                <p><span style="color:#333333;">Since the database is dropped (i.e. deleted) before it&#8217;s created again, this database initializer should not be used once an application has gone into production in order to prevent data loss.</span></p>
                <p><span style="color:#333333;">When using the Code First workflow, EF compiles a list of the entities and their properties, and for each property, characteristics such as its data type and nullability into the EDMX. &#8220;Conceptual Model&#8221;.</span></p>
                <p><span style="color:#333333;">The Storage Model describes how data is stored in the database and the Conceptual-Storage Mappings describe how the Conceptual Model maps to the Storage Model.</span></p>
                <p><span style="color:#333333;">By default, when using the Code First workflow, the first time that we access one of the context&#8217;s DbSet properties, EF will &#8220;check if the database exists, and it doesn&#8217;t exist, it&#8217;ll create it&#8221;.</span></p>
                <p><span style="color:#333333;">By default, Entity Framework uses the CreateDatabaseIfNotExists database initializer.</span></p>
                <p><span style="color:#333333;">Visual Studio&#8217;s SQL Server Object Explorer window can be used to view a SQL Server LocalDB database&#8217;s tables and data.</span></p>
                <p><span style="color:#333333;">The SQL Server Object Explorer window also exposes a set of commands that allow you to create new databases and add tables to existing databases.</span></p>
                <p><span style="color:#333333;">When using the Code First workflow, EF adds every entity property as a table column. &#8220;False&#8221;.</span></p>
                <p><span style="color:#333333;">EF only adds table columns for entity properties that have a setter—public, protected, or private.</span></p>
                <p><span style="color:#333333;">For the entity property public string Name { get; set; }, what SQL Server column data type would EF use for the table column? &#8220;nvarchar(MAX)&#8221;</span></p>
                <p><span style="color:#333333;">The &#8220;MAX&#8221; part within the parentheses indicates that the column can contain a string as large as the maximum allowed size—which is a very large string, 2GB or approximately a billion characters.</span></p>
                <p><span style="color:#333333;">When EF detects an existing database, it queries the EDMX from the &#8220;MigrationHistory&#8221; table and compares the current, in-memory model to the model stored in the database and throws an exception if they aren&#8217;t compatible when using the default CreateDatabaseIfNotExists database initializer. &#8220;True&#8221;</span></p>
                <p><span style="color:#333333;">The DropCreateDatabaseAlways and DropCreateDatabaseIfModelChanges database initializers allow you to customize this behavior.</span></p>
                <p><span style="color:#333333;">During development, which of the following database initializer classes can be used to drop and create the database every time that a change to the model is made? &#8220;DropCreateDatabaseModelChanges&#8221;.</span></p>
                <p><span style="color:#333333;">Since the database is dropped (i.e. deleted) before it&#8217;s created again, this database initializer should not be used once an application has gone into production in order to prevent data loss.</span></p>
                <p><span style="color:#333333;">When EF creates your database, it includes a table named &#8220;MigrationHistory&#8221; that contains a compressed version of the EDMX for the model that was used to create the database.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES: Entity Data Model</strong></span></p>
                <p><span style="color:#333333;">When an instance of entity &#8220;A&#8221; can be associated with one or more instances of entity &#8220;B&#8221; and an instance of entity &#8220;B&#8221; can also be associated with one or more instances of entity &#8220;A&#8221;, those entities are said to be in a &#8220;Many-to-Many&#8221; relationship.</span></p>
                <p><span style="color:#333333;">Representing a Many-to-Many relationship in the database requires either an implicit or explicit bridge table.</span></p>
                <p><span style="color:#333333;">When defining a many-to-many relationship without defining an explicit bridge entity class, Entity Framework will automatically add an &#8220;implicit&#8221; bridge table to the database in order to store the relationship data.</span></p>
                <p><span style="color:#333333;">Defining an explicit Many-to-Many bridge entity class allows you to include additional properties beyond the properties that are needed to define the relationship. &#8220;True&#8221;</span></p>
                <p><span style="color:#333333;">These additional properties are often referred to as &#8220;payload&#8221;.</span></p>
                <p><span style="color:#333333;">The Required data annotation attribute can be used on nullable entity properties to make their associated database table columns not allow nulls.</span></p>
                <p><span style="color:#333333;">The Include method can be used in a LINQ query to load related data. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">Using the Include method to load related data is known as &#8220;eager&#8221; loading.</span></p>
                <p><span style="color:#333333;">&#8220;Navigation&#8221; properties allow you to define relationships between entities.</span></p>
                <p><span style="color:#333333;">&#8220;Seeding&#8221; your database is the process of initially populating your database with data.</span></p>
                <p><span style="color:#333333;">Sometimes the seed data is fake or dummy data that enables the development or testing of the system; sometimes it&#8217;s data that needs to be present in order for the system to operate correctly.</span></p>
                <p><span style="color:#333333;">You can override the DbContext class &#8220;OnModelCreating&#8221; method in order to customize EF&#8217;s conventions or use EF&#8217;s fluent API to refine your model.</span></p>
                <p><span style="color:#333333;">It&#8217;s possible to rely completely upon the fluent API to refine your model and not use any data annotation attributes in your entity classes.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES: LINQ Queries</strong></span></p>
                <p><span style="color:#333333;">The behavior of LINQ to Entities queries not executing until they&#8217;re enumerated—either by using a loop or by calling a method on the query like ToList or Count—is called &#8220;Deferred Execution&#8221;.</span></p>
                <p><span style="color:#333333;">Deferred execution allows queries to be executed more than once or to be combined or extended before they&#8217;re executed.</span></p>
                <p><span style="color:#333333;">The DbSet &#8220;Find&#8221; method will check if the entity is being tracked by the context, and if it is, return a reference to that entity, otherwise it&#8217;ll retrieve the entity from the database.</span></p>
                <p><span style="color:#333333;">Whereas a DbSet LINQ query will always cause EF to generate and execute a SQL query against the database, the DbSet Find will only result in a database query if the entity is not being tracked by the context.</span></p>
                <p><span style="color:#333333;">The SingleOrDefault LINQ operator will throw an exception if more than one entity is found whereas the FirstOrDefault operator returns the first entity if more than one is found. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">The Single and First LINQ operators go a step further and enforce that at least one entity is found by throwing an exception if no matching entities are found.</span></p>
                <p><span style="color:#333333;">When &#8220;explicitly&#8221; loading entities, related entities are loaded using the Load method on the related entity&#8217;s entry.</span></p>
                <p><span style="color:#333333;">As with lazy loading, this approach allows you to only load the related entities if or when they&#8217;re needed.</span></p>
                <p><span style="color:#333333;">When &#8220;eagerly&#8221; loading related entities, you write a single query that not only retrieves the data for the main entity but also the data for the related entities.</span></p>
                <p><span style="color:#333333;">When eagerly loading related entities, the Include method is used to tell EF which related entities to load.</span></p>
                <p><span style="color:#333333;">When &#8220;lazily&#8221; loading related entities, related entities are not loaded until their navigation properties are accessed for the first time.</span></p>
                <p><span style="color:#333333;">The process of lazily loading related entities is automatically handled by EF using dynamic proxies, which makes this option for loading related data easy to use. The downside is that multiple queries are needed in order to retrieve the data.</span></p>
                <p><span style="color:#333333;">A DbSet query to retrieve a single entity will only result in a query being generated and executed against the database if the entity isn&#8217;t available in the context. &#8220;false&#8221;.</span></p>
                <p><span style="color:#333333;">The query will be generated and executed against the database even if the entity is already in the context.</span></p>
                <p><span style="color:#333333;">To enable lazy loading, navigation properties need to be marked as &#8220;virtual&#8221;, which allows EF to create dynamic proxies by subclassing your entities and overriding your navigation properties.</span></p>
                <p><span style="color:#333333;">The overridden navigation properties give EF the ability to detect when those properties are accessed, and retrieve the data for those properties when it is needed.</span></p>
                <p><span style="color:#333333;">If you need to sort on more than one column in a LINQ query, you can make multiple calls to the OrderBy or OrderByDescending methods. &#8220;false&#8221;.</span></p>
                <p><span style="color:#333333;">Unlike the Where operator, only the last call to the OrderBy or OrderByDescending methods will be used.</span></p>
                <hr />
                <p><span style="color:#333333;"><strong>NOTES: CRUD Operations</strong></span></p>
                <p><span style="color:#333333;">Adding an entity to the context by calling the DbSet &#8220;Add&#8221; method will set the entity&#8217;s state to &#8220;Added&#8221;.</span></p>
                <p><span style="color:#333333;">Not only will the entity&#8217;s state be set to &#8220;Added&#8221;, but each of the entity&#8217;s related or child entity states will also be set to &#8220;Added&#8221;.</span></p>
                <p><span style="color:#333333;">When deleting an entity, EF will—by default—cascade delete any dependent entities whose foreign key properties are not nullable. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">If the foreign key property is nullable, then EF will set the property value to null when the principal entity is deleted.</span></p>
                <p><span style="color:#333333;">To successfully delete an entity, every property on the entity must have a value. &#8220;False&#8221;.</span></p>
                <p><span style="color:#333333;">The only property that needs a value is the entity&#8217;s key property, which is used to identify the database table row to delete.</span></p>
                <p><span style="color:#333333;">After attaching a disconnected entity to the context using the Attach method, its state will be set to &#8220;unchanged&#8221;.</span></p>
                <p><span style="color:#333333;">The entity&#8217;s state is set to &#8220;Unchanged&#8221; after attaching it to the context using the Attach method.</span></p>
                <p><span style="color:#333333;">EF can be forced to treat an entity&#8217;s values as &#8220;new&#8221; values by setting the associated entry&#8217;s state to &#8220;modified&#8221;.</span></p>
                <p><span style="color:#333333;">When calling the SaveChanges method, EF will persist each of the &#8220;Modified&#8221; entity&#8217;s property values to the database.</span></p>
                <p><span style="color:#333333;">To delete an entity, it must be tracked by the context before calling the DbSet Remove method. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">If we want to avoid having to retrieve the entity from the database, we can create a simple stub entity and attach it to the context.</span></p>
                <p><span style="color:#333333;">Defining foreign key properties gives you the ability to associate a related principal entity by just setting a foreign key property value on the dependent entity. &#8220;True&#8221;.</span></p>
                <p><span style="color:#333333;">Because of this, we only need the ID of the principal entity that we want to associate and not the entire entity object instance.</span></p>
                <p><span style="color:#333333;">Entities that are not being tracked by the context are said to be disconnected or &#8220;detached&#8221;.</span></p>
                <p><span style="color:#333333;">Changes made to detached entities are not tracked by the context.</span></p>
                <p><span style="color:#333333;">Each entity in the context that has a state of &#8220;Added&#8221; will be inserted into the database when the context&#8217;s &#8220;SaveChanges&#8221; method is called.</span></p>
                <p><span style="color:#333333;">Changing an entry&#8217;s state from &#8220;Added&#8221; to &#8220;Unchanged&#8221; before calling the SaveChanges method will prevent the entity from being inserted into the database.</span></p>
                <p><span style="color:#333333;">When calling the context&#8217;s Entry method, if the passed in entity is not in the context, EF will attach it and set its state to &#8220;unchanged&#8221;.</span></p>



            </div>
            <div class="col-sm-2">
                <h3></h3>
            </div>
        </div><br>
    </div>



    <br>
    <br>
    <br>
    <br>

</body>
</html>
